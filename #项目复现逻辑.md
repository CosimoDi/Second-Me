# é¡¹ç›®å¤ç°æŒ‡å—

## 1. åŸºç¡€å¤ç°æ­¥éª¤
1. **ä¸‹è½½é¡¹ç›®**: ä¸‹è½½å¹¶è§£å‹ï¼Œè‹¥ `git clone` å¤±è´¥åˆ™æ‰‹åŠ¨ä¸‹è½½ã€‚
2. **ç¯å¢ƒå‡†å¤‡**: å®‰è£… Dockerï¼Œå¹¶é…ç½®å¥½ WSL (Windows Subsystem for Linux)ã€‚
3. **å¯åŠ¨æœåŠ¡**: åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œ `make docker-up`ã€‚
4. **è®¿é—®åº”ç”¨**: æµè§ˆå™¨è®¿é—® `localhost:3000`ã€‚

å¦‚æœå“ªä¸€æ­¥æé”™äº†ä»¥è‡³äºè¦å…¨é‡æ–°æï¼Œbuildè¿™ä¸€æ­¥å°±éœ€è¦Building 2597.4sï¼Œåé¢è·‘ä¸€éæ¨¡å‹è®­ç»ƒå·®ä¸å¤šä¹Ÿæ˜¯ä¸€å°æ—¶ï¼ˆæ²¡æŠ¥é”™çš„æƒ…å†µä¸‹ï¼‰ã€‚æ”¹bugæœ€å¥½è¿˜æ˜¯è¦è°¨æ…ã€‚

## 2. WSL ä»£ç†é…ç½® (å…³é”®)

ç”±äº WSL 2 é»˜è®¤ä¸æ”¯æŒç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„ localhost ä»£ç†ï¼Œä¸” IP åœ°å€å¯èƒ½ä¼šå˜åŠ¨ï¼Œæœ¬é¡¹ç›®æä¾›äº†è‡ªåŠ¨åŒ–è„šæœ¬ä»¥ä¾¿å¿«é€Ÿé…ç½®ã€‚

### è„šæœ¬ä½ç½®
è„šæœ¬ä½äº `scripts/setup_wsl_proxy.sh`ã€‚

### å¦‚ä½•é…ç½®ä»£ç† (åˆæ¬¡ä½¿ç”¨ & IP/ç«¯å£å˜æ›´)
å½“ä½ è¿æ¥æ–°çš„ WiFi æˆ– IP åœ°å€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ›´æ–° WSL ä»£ç†ï¼š

**æ–¹æ³• 1ï¼šä½¿ç”¨é…ç½®è„šæœ¬ (æ¨è)**
åœ¨ PowerShell ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæ›¿æ¢ä¸ºä½ å½“å‰çš„å®¿ä¸»æœº IP å’Œä»£ç†ç«¯å£ï¼‰ï¼š

```powershell
# è¯­æ³•: wsl bash scripts/setup_wsl_proxy.sh [å®¿ä¸»æœºIP] [ä»£ç†ç«¯å£]
wsl bash scripts/setup_wsl_proxy.sh 192.168.2.101 16780
```

**æ–¹æ³• 2ï¼šæ‰‹åŠ¨ä¿®æ”¹**
1. è¿›å…¥ WSL: `wsl`
2. ç¼–è¾‘ä»£ç†æ–‡ä»¶: `nano ~/.bash_proxy`
3. ä¿®æ”¹ IP å’Œç«¯å£
4. ç”Ÿæ•ˆé…ç½®: `source ~/.bashrc`

### Docker ä»£ç†é—®é¢˜ (å…³é”®ï¼šæ„å»ºæŠ¥é”™)
**ç°è±¡**: è¿è¡Œ `make docker-up` æ—¶å‡ºç° `failed to solve... failed to fetch oauth token... dial tcp ... connectex` é”™è¯¯ã€‚

**åŸå› **: Docker CLI æ„å»ºè¿›ç¨‹æ²¡æœ‰å¤ç”¨ Docker Desktop çš„å…¨å±€ä»£ç†è®¾ç½®ï¼Œæˆ–è€…é€šè¿‡ WSL è°ƒç”¨æ—¶ç¯å¢ƒå˜é‡æœªæ­£ç¡®ä¼ é€’ã€‚

**âœ… è§£å†³æ–¹æ¡ˆ (ç«‹å³ç”Ÿæ•ˆ)**:
ä¸è¦åªä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œç›´æ¥åœ¨å½“å‰ PowerShell çª—å£è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå¼ºåˆ¶ Docker èµ°ä»£ç†ï¼š

```powershell
# 1. è®¾ç½®ä»£ç† (å…³é”®æ­¥éª¤ï¼æ›¿æ¢ä¸ºä½ çš„å®é™… IP å’Œç«¯å£)
$env:HTTP_PROXY="http://192.168.2.101:16780"
$env:HTTPS_PROXY="http://192.168.2.101:16780"

# 2. å†æ¬¡å°è¯•æ„å»º
make docker-up
```

**âŒ ä¸æ¨èçš„åšæ³•**:
*   ä»…ä¿®æ”¹ `settings-store.json` æˆ– Docker Desktop GUI è®¾ç½®ï¼šé€šå¸¸éœ€è¦é‡å¯ Docker è¿›ç¨‹æ‰èƒ½ç”Ÿæ•ˆï¼Œä¸”å¯¹å‘½ä»¤è¡Œæ„å»ºå¯èƒ½æ— æ•ˆã€‚
*   æŸ¥çœ‹ `Local\Docker\log`ï¼šæ•ˆç‡è¾ƒä½ï¼Œç½‘ç»œè¿æ¥é—®é¢˜é€šå¸¸å¾ˆç›´æ¥ã€‚

## 3. æ¨¡å‹æœåŠ¡é…ç½® (Ollama)

ç”±äºæ— æ³•è·å– OpenAI APIï¼Œä½¿ç”¨è‡ªå®šä¹‰æ¨¡å‹ (Custom Model) è¿›è¡Œè®­ç»ƒã€‚

**é…ç½®ä¿¡æ¯:**
*   **Chat**: `qwen3:8b` -> `http://192.168.2.101:11434/v1` (æ›¿æ¢ä¸ºå®é™…IP)
*   **Embedding**: `qwen3-embedding:latest` -> `http://192.168.2.101:11434/v1`
*   **Thinking**: `http://192.168.2.101:11434/v1`

### å¯åŠ¨ Ollama (PowerShell è„šæœ¬)
**æ³¨æ„**: è¿è¡Œè¿‡ç¨‹æœ€å¥½ä¸è¦æ”¹å˜ IP åœ°å€ã€‚å»ºè®®å¦å­˜ä¸º `start_ollama.ps1` è¿è¡Œã€‚

```powershell
# 1. ç»ˆæ­¢æ®‹ç•™è¿›ç¨‹
taskkill /F /IM ollama.exe 2>&1 | Out-Null
Start-Sleep -Seconds 3

# 2. æ¸…ç©ºæ—§ç¯å¢ƒå˜é‡ï¼ˆå…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œé¿å…åˆ é™¤æŠ¥é”™ï¼‰
if (Test-Path Env:OLLAMA_CUDA) { Remove-Item Env:OLLAMA_CUDA }
if (Test-Path Env:OLLAMA_MAX_GPU) { Remove-Item Env:OLLAMA_MAX_GPU }

# 3. é€‚é… RTX 4060 8G æ˜¾å­˜çš„ GPU é…ç½®
$env:OLLAMA_OPENAI_COMPATIBLE=1
$env:OLLAMA_GPU=90
$env:OLLAMA_OFFLOAD_ALL=1
$env:OLLAMA_HOST="0.0.0.0:11434"
$env:OLLAMA_NUM_GPU=1

# 4. å¯åŠ¨ Ollama å¹¶åœ¨æ§åˆ¶å°å®æ—¶è¾“å‡ºæ—¥å¿—
Write-Host "ğŸ”„ æ­£åœ¨å¯åŠ¨OllamaæœåŠ¡...ï¼ˆæ§åˆ¶å°å®æ—¶è¾“å‡ºæ—¥å¿—ï¼‰" -ForegroundColor Cyan
& "$env:LOCALAPPDATA\Programs\Ollama\ollama.exe" serve 2>&1 | ForEach-Object {
    if ($_ -notmatch "failed to get console mode for stderr") {
        if ($_ -match "level=INFO") { Write-Host $_ -ForegroundColor White }
        elseif ($_ -match "level=WARN") { Write-Host $_ -ForegroundColor Yellow }
        elseif ($_ -match "level=ERROR") { Write-Host $_ -ForegroundColor Red }
        else { Write-Host $_ -ForegroundColor Blue }
    }
}
```

### éªŒè¯æ¨¡å‹æœåŠ¡
ä¿®æ”¹ endpoint ä¸ºæœ¬æœº IPï¼Œæ–°å»º PowerShell çª—å£æµ‹è¯•ï¼š
```powershell
Invoke-RestMethod -Uri "http://192.168.2.101:11434/v1/models" -Method Get
```

## 4. è®­ç»ƒæµç¨‹å¸¸è§é—®é¢˜ (Troubleshooting)

### API é€‰æ‹©å»ºè®®
*   **é¦–é€‰**: ç¡…åŸºæµåŠ¨ (SiliconFlow) - ç¨³å®šï¼Œçœå»æœ¬åœ°æŠ˜è…¾ã€‚
*   **æ¬¡é€‰**: Ollama (æœ¬åœ°è‡ªå®šä¹‰æ¨¡å‹) - éœ€è¦è¾ƒå¥½çš„ç¡¬ä»¶é…ç½®ã€‚

### è®­ç»ƒå¡é¡¿ä¸æŠ¥é”™è§£ç­”
| é˜¶æ®µ | å¸¸è§ç°è±¡ | è§£å†³æ–¹æ¡ˆ |
| :--- | :--- | :--- |
| **ç™»å½•/å¯åŠ¨** | æŠ¥é”™ 500 | å¯èƒ½æ˜¯ä¹‹å‰è®­ç»ƒä¸­æ–­å¯¼è‡´ã€‚å°è¯• `git reset --hard HEAD~n` å›é€€ç‰ˆæœ¬ã€‚ |
| **æœ¬åœ°ç™»å½•** | `SSL: CERTIFICATE_VERIFY_FAILED` | **åŸå› **: `app.secondme.io` è¯ä¹¦è¿‡æœŸã€‚**ä¿®å¤**: åœ¨ [lpm_kernel/api/domains/upload/client.py](lpm_kernel/api/domains/upload/client.py) çš„ `count_uploads()` ä¸­ä¸º `requests.get()` æ·»åŠ  `verify=False`ï¼Œç»•è¿‡è¯ä¹¦æ ¡éªŒã€‚ |
| **Generate Document Embeddings** | docker æ— æ³•è®¿é—® ollama | 1. ç¡®ä¿¡ Ollama å¯åŠ¨æ—¶è®¾ç½®äº† `$env:OLLAMA_HOST = "0.0.0.0:11434"`ã€‚<br>2. æ£€æŸ¥ IP åœ°å€æ˜¯å¦æ­£ç¡®ã€‚<br>3. è‹¥ Ollama å¡ä½ï¼Œåœ¨å¯åŠ¨å®ƒçš„ PowerShell çª—å£æŒ‰å›è½¦æ¿€æ´»ã€‚ |
| **Generate Biography** | æŠ¥é”™ 500 / è¶…æ—¶ | æ¨¡å‹è¿‡å¤§æˆ–è¶…æ—¶è®¾ç½®è¿‡çŸ­ã€‚å»ºè®®æ›´æ¢è½»é‡æ¨¡å‹æˆ–å‘½ä»¤ Copilot è°ƒæ•´è¶…æ—¶æ—¶é—´ã€‚ |
| **Map Your Entity Network** | é€Ÿåº¦æ…¢ | æ­£å¸¸ç°è±¡ï¼Œé£æ‰‡è½¬åŠ¨ä¸”æ—¥å¿—æœ‰æ›´æ–°å³ä¸ºæ­£å¸¸ã€‚ |
| **Train** | è¿›åº¦å¡åœ¨ 93% | 1. æ£€æŸ¥ CUDA é€‚é…ã€‚<br>2. è¿›ç¨‹ç»ˆæ­¢å¤±è´¥ PID é”™è¯¯ï¼šä»£ç å¯èƒ½é”™è¯¯è¯†åˆ«äº†ä¸»è¿›ç¨‹ PID è€Œéå­è¿›ç¨‹ PIDã€‚ |
